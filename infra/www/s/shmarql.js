'use strict';import{AssertionError,AttributeError,BaseException,DeprecationWarning,Exception,IndexError,IterableError,KeyError,NotImplementedError,RuntimeWarning,StopIteration,UserWarning,ValueError,Warning,__JsIterator__,__PyIterator__,__Terminal__,__add__,__and__,__call__,__class__,__envir__,__eq__,__floordiv__,__ge__,__get__,__getcm__,__getitem__,__getslice__,__getsm__,__gt__,__i__,__iadd__,__iand__,__idiv__,__ijsmod__,__ilshift__,__imatmul__,__imod__,__imul__,__in__,__init__,__ior__,__ipow__,
__irshift__,__isub__,__ixor__,__jsUsePyNext__,__jsmod__,__k__,__kwargtrans__,__le__,__lshift__,__lt__,__matmul__,__mergefields__,__mergekwargtrans__,__mod__,__mul__,__ne__,__neg__,__nest__,__or__,__pow__,__pragma__,__pyUseJsNext__,__rshift__,__setitem__,__setproperty__,__setslice__,__sort__,__specialattrib__,__sub__,__super__,__t__,__terminal__,__truediv__,__withblock__,__xor__,abs,all,any,assert,bool,bytearray,bytes,callable,chr,copy,deepcopy,delattr,dict,dir,divmod,enumerate,filter,float,getattr,
hasattr,input,int,isinstance,issubclass,len,list,map,max,min,object,ord,pow,print,property,py_TypeError,py_iter,py_metatype,py_next,py_reversed,py_typeof,range,repr,round,set,setattr,sorted,str,sum,tuple,zip}from"./org.transcrypt.__runtime__.js";import{A,Address,Area,Article,Aside,Audio,B,Blockquote,Body,Br,Button,Canvas,Caption,Cite,Code,Col,Datalist,Dd,Div,Dl,Dt,Em,Embed,Fieldset,Figcaption,Figure,Footer,Form,H1,H2,H3,H4,H5,H6,Head,Header,Hr,Html,HtmlElement,I,Img,Input,KWElement,Label,Legend,Li,
Link,Main,Map,Meta,Meter,Nav,Noscript,Object,Ol,Optgroup,Option,Output,P,Param,Pre,Progress,S,Samp,Script,Section,Select,Small,Source,Span,Strong,Style,Sub,Sup,Table,Tbody,Td,Textarea,Tfoot,Th,Thead,Title,Tr,Track,U,Ul,Video,convertAttrKeys,indented,renderCss,renderInlineStyle}from"./htmltree.js";var __name__="__main__";export var status_box=document.getElementById("status_box");export var results_element=document.getElementById("results");document.curr_s="?s";document.curr_p="?p";document.curr_o=
"?o";export var PREFIX=dict({"https://www.nfdi4culture.de/ontology/":"nfdico:","https://www.nfdi4culture.de/resource/":"nfdires:","http://www.w3.org/1999/02/22-rdf-syntax-ns#":"rdf:","http://www.w3.org/2000/01/rdf-schema#":"rdfs:","http://www.w3.org/2002/07/owl#":"owl:"});export var triplestore_map=dict({"fuseki":"/fuseki/sparql","blazegraph":"/bigdata/namespace/kb/sparql"});export var find_attr_parents=function(element,attr){var val=element.getAttribute(attr);if(val&&len(val)>0)return val;var parent=
element.parentElement;if(parent)return find_attr_parents(parent,attr)};export var snippet=function(param,elem){var value=elem["value"];var d=Div();if(elem["type"]=="uri"){if(param=="s"&&value==document.curr_s)d.C.append(Span("&middot;"));else d.C.append(Span("S",__kwargtrans__({_class:"selektor",uri:value,wanted:"S"})));if(param=="p"&&value==document.curr_p)d.C.append(Span("&middot;"));else d.C.append(Span("P",__kwargtrans__({_class:"selektor",uri:value,wanted:"P"})));if(param=="o"&&value==document.curr_o)d.C.append(Span("&middot;"));
else d.C.append(Span("O",__kwargtrans__({_class:"selektor",uri:value,wanted:"O"})));var display_value=value;for(var [prefix,replacement]of PREFIX.py_items())if(value.startswith(prefix))var display_value=value.py_replace(prefix,replacement);d.C.append(A(display_value,__kwargtrans__({href:value,target:"other",style:dict({"text-decoration":"none","color":"black"})})))}else d.C.append(Span(value));return d.render()};export var display_query=function(results){var thead_tr=Tr();for(var headvar of results["head"]["vars"])thead_tr.C.append(Td(headvar));
var tbody=Tbody();for(var row of results["results"]["bindings"]){var arow=Tr();for(var [k,v]of dict(row).py_items())arow.C.append(Td(v["value"]));tbody.C.append(arow)}var t=Table(Thead(thead_tr),tbody,__kwargtrans__({_class:"table table-striped"}));document.getElementById("query_results").innerHTML=t.render()};export var display_explore=function(results){if(__in__("results",results)&&__in__("bindings",results["results"]))var results=results["results"]["bindings"];var t=Table(Thead(Tr(Th(Span(document.curr_s,
__kwargtrans__({_class:"btn btn-sm",uri:"?s",wanted:"S"}))),Th(Span(document.curr_p,__kwargtrans__({_class:"btn btn-sm",uri:"?p",wanted:"P"}))),Th(Span(document.curr_o,__kwargtrans__({_class:"btn btn-sm",uri:"?o",wanted:"O"}))))),__kwargtrans__({_class:"table table-striped"}));var tbody=Tbody();t.C.append(tbody);for(var row of results){if(!__in__("s",row))row["s"]=dict({"type":"uri","value":document.curr_s});if(!__in__("p",row))row["p"]=dict({"type":"uri","value":document.curr_p});if(!__in__("o",
row))row["o"]=dict({"type":"uri","value":document.curr_o});tbody.C.append(Tr(Td(snippet("s",row["s"])),Td(snippet("p",row["p"])),Td(snippet("o",row["o"]))))}var buf=t.render();results_element.innerHTML=buf};export var sparql=async function(q){var ts=get_endpoint();var endpoint=triplestore_map.py_get(ts,"/fuseki/sparql");var res=await fetch(endpoint,{"method":"POST","headers":{"Accept":"application/sparql-results+json","Content-Type":"application/x-www-form-urlencoded"},"body":"query="+encodeURIComponent(q)});
if(res.status!=200){var txt=await res.text();return{"error":txt}}return await res.json()};export var flash=function(msg){status_box.innerHTML=msg;status_box.style.display="block"};export var get_endpoint=function(){var ts="fuseki";for(var elem of document.getElementsByName("triplestores"))if(elem.checked==true)return elem.value};export var change_endpoint=async function(){var ts=get_endpoint();results_element.innerHTML='<div style="margin-top: 20px" class="spinner-border" role="status">'+ts+'<span class="visually-hidden">Loading...</span></div>';
var q="SELECT * WHERE { ";if(document.curr_s!="?s")q+="<"+document.curr_s+"> ";else q+=document.curr_s+" ";if(document.curr_p!="?p")q+="<"+document.curr_p+"> ";else q+=document.curr_p+" ";if(document.curr_o!="?o")q+="<"+document.curr_o+">";else q+=document.curr_o;q+=" } ORDER BY ?s LIMIT 1000";var results=await sparql(q);display_explore(results)};export var results_clicker=async function(event){document.getElementById("status_box").style.display="none";var wanted=find_attr_parents(event.target,"wanted");
var uri=find_attr_parents(event.target,"uri");if(wanted=="S")document.curr_s=uri;if(wanted=="P")document.curr_p=uri;if(wanted=="O")document.curr_o=uri;change_endpoint()};export var execute_sparql_clicker=async function(event){var results=await sparql(editor.getValue());if(__in__("error",results))document.getElementById("query_results").innerHTML=results["error"];else display_query(results)};export var navtabs_clicker=async function(event){event.preventDefault();document.getElementById("sprql").style.display=
"none";document.getElementById("shmrql").style.display="none";for(var nav_link of document.getElementsByClassName("nav-link"))nav_link.classList.remove("active");event.target.classList.add("active");var tabid=find_attr_parents(event.target,"tabid");if(len(tabid)>2){var elemt=document.getElementById(tabid);elemt.style.display="block";if(tabid=="shmrql")change_endpoint()}};export var E=__class__("E",[object],{__module__:__name__,get preventDefault(){return __get__(this,function(){})}});export var init=
async function(){var execute_sparql=document.getElementById("execute_sparql");execute_sparql.addEventListener("click",execute_sparql_clicker);var navtabs=document.getElementById("navtabs");navtabs.addEventListener("click",navtabs_clicker);results_element.addEventListener("click",results_clicker);if(window.location.hash=="#query"){var e=E();e.target=document.getElementById("tabsprql");navtabs_clicker(e)}else{document.getElementById("sprql").style.display="none";change_endpoint()}};window.addEventListener("load",
init);

//# sourceMappingURL=shmarql.map